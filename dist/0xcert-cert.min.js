!function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=110)}({10:function(e,t){e.exports=void 0},110:function(e,t,n){window.$0xcert=window.$0xcert||{},Object.assign(window.$0xcert,n(66))},15:function(e,t,n){"use strict";function i(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),i(n(16)),i(n(18)),i(n(19)),i(n(20)),i(n(21)),i(n(22)),i(n(23))},16:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))(function(o,r){function s(e){try{c(i.next(e))}catch(e){r(e)}}function u(e){try{c(i.throw(e))}catch(e){r(e)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(s,u)}c((i=i.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.fetch=function(e,t){return i(this,void 0,void 0,function*(){return"undefined"!=typeof window?window.fetch(e,t):n(17)(e,t)})}},17:function(e,t,n){"use strict";var i=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==i)return i;throw new Error("unable to locate global object")}();e.exports=t=i.fetch,t.default=i.fetch.bind(i),t.Headers=i.Headers,t.Request=i.Request,t.Response=i.Response},18:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))(function(o,r){function s(e){try{c(i.next(e))}catch(e){r(e)}}function u(e){try{c(i.throw(e))}catch(e){r(e)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(s,u)}c((i=i.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.sha=function(e,t){return i(this,void 0,void 0,function*(){if("undefined"!=typeof window){const n=new window.TextEncoder("utf-8").encode(t),i=yield window.crypto.subtle.digest(`SHA-${e}`,n);return Array.from(new Uint8Array(i)).map(e=>("00"+e.toString(16)).slice(-2)).join("")}return n(10).createHash(`sha${e}`).update(t).digest("hex")})}},19:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toFloat=function(e){return parseFloat(`${e}`)||0}},20:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toInteger=function(e){return parseInt(`${e}`)||0}},21:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toSeconds=function(e){return parseInt(`${parseFloat(`${e}`)/1e3}`)||0}},22:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toString=function(e){return null!=e?e.toString():null}},23:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toTuple=function e(t){if(!(t instanceof Object))return[];var n=[],i=0;return Object.keys(t).forEach(o=>{if(t[o]instanceof Object)n[i]=e(t[o]);else if(t[o]instanceof Array){let r=0,s=[];t[o].forEach(n=>{s[r]=e(t[o]),r++}),n[i]=s}else n[i]=t[o];i++}),n}},66:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(67))},67:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))(function(o,r){function s(e){try{c(i.next(e))}catch(e){r(e)}}function u(e){try{c(i.throw(e))}catch(e){r(e)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(s,u)}c((i=i.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const o=n(15),r=n(68),s=n(70);t.Cert=class{constructor(e){this.schema=e.schema,this.merkle=new r.Merkle(Object.assign({hasher:e=>o.sha(256,s.toString(e))},e))}notarize(e){return i(this,void 0,void 0,function*(){const t=this.buildSchemaProps(e),n=yield this.buildCompoundProps(t);return(yield this.buildProofs(n)).map(e=>({path:e.path,nodes:e.nodes,values:e.values}))})}disclose(e,t){return i(this,void 0,void 0,function*(){const n=this.buildSchemaProps(e),i=yield this.buildCompoundProps(n);return(yield this.buildProofs(i,t)).map(e=>({path:e.path,nodes:e.nodes,values:e.values}))})}calculate(e,t){return i(this,void 0,void 0,function*(){try{return this.checkDataInclusion(e,t)?this.imprintProofs(t):null}catch(e){return null}})}imprint(e){return i(this,void 0,void 0,function*(){return this.notarize(e).then(e=>e[0].nodes[0].hash)})}buildSchemaProps(e,t=this.schema,n=[]){return"array"===t.type?(e||[]).map((e,i)=>this.buildSchemaProps(e,t.items,[...n,i])).reduce((e,t)=>e.concat(t),[]):"object"===t.type?Object.keys(t.properties).sort().map(i=>{const o=this.buildSchemaProps((e||{})[i],t.properties[i],[...n,i]);return-1===["object","array"].indexOf(t.properties[i].type)?[o]:o}).reduce((e,t)=>e.concat(t),[]):{path:n,value:e,key:n.join("."),group:n.slice(0,-1).join(".")}}buildCompoundProps(e){return i(this,void 0,void 0,function*(){e=[...e];const t=this.buildPropGroups(e),n=Object.keys(t).sort((e,t)=>e>t?-1:1).filter(e=>""!==e);for(const i of n){const n=t[i],o=[...e.filter(e=>e.group===i)].sort((e,t)=>e.key>t.key?1:-1).map(e=>e.value),r=yield this.merkle.notarize(o);e.push({path:n,value:r.nodes[0].hash,key:n.join("."),group:n.slice(0,-1).join(".")})}return e.sort((e,t)=>e.key>t.key?1:-1)})}buildProofs(e,t=null){return i(this,void 0,void 0,function*(){const n=t?s.stepPaths(t).map(e=>e.join(".")):null,o={};return e.forEach(e=>o[e.group]=e.path.slice(0,-1)),Promise.all(Object.keys(o).map(t=>i(this,void 0,void 0,function*(){const i=e.filter(e=>e.group===t).map(e=>e.value);let r=yield this.merkle.notarize(i);if(n){const i=e.filter(e=>e.group===t).map((e,t)=>-1===n.indexOf(e.key)?-1:t).filter(e=>-1!==e);r=yield this.merkle.disclose(r,i)}if(!n||-1!==n.indexOf(o[t].join(".")))return{path:o[t],values:r.values,nodes:r.nodes,key:o[t].join("."),group:o[t].slice(0,-1).join(".")}}))).then(e=>e.filter(e=>!!e))})}checkDataInclusion(e,t){const n=this.buildSchemaProps(e);t=s.cloneObject(t).map(e=>Object.assign({key:e.path.join("."),group:e.path.slice(0,-1).join(".")},e));for(const i of n){const n=s.readPath(i.path,e);if(void 0===n)continue;const o=i.path.slice(0,-1).join("."),r=t.find(e=>e.key===o);if(!r)return!1;const u=this.getPathIndexes(i.path).pop();if(r.values.find(e=>e.index===u).value!==n)return!1}return!0}imprintProofs(e){return i(this,void 0,void 0,function*(){if(0===e.length)return this.getEmptyImprint();e=s.cloneObject(e).map(e=>Object.assign({key:e.path.join("."),group:e.path.slice(0,-1).join(".")},e)).sort((e,t)=>e.path.length>t.path.length?-1:1);for(const t of e){const n=yield this.merkle.imprint(t).catch(()=>"");t.nodes.unshift({index:0,hash:n});const i=t.path.slice(0,-1).join("."),o=this.getPathIndexes(t.path).slice(-1).pop(),r=e.find(e=>e.key===i);r&&r.values.unshift({index:o,value:n})}const t=e.find(e=>""===e.key);return t?t.nodes.find(e=>0===e.index).hash:this.getEmptyImprint()})}getPathIndexes(e){const t=[];let n=this.schema;for(const i of e)"array"===n.type?(t.push(i),n=n.items):"object"===n.type?(t.push(Object.keys(n.properties).sort().indexOf(i)),n=n.properties[i]):t.push(void 0);return t}getEmptyImprint(){return i(this,void 0,void 0,function*(){return this.merkle.notarize([]).then(e=>e.nodes[0].hash)})}buildPropGroups(e){const t={};return e.map(e=>{let t=[];return e.path.map(e=>(t.push(e),[...t]))}).reduce((e,t)=>e.concat(t),[]).forEach(e=>t[e.slice(0,-1).join(".")]=e.slice(0,-1)),t}}},68:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(69))},69:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))(function(o,r){function s(e){try{c(i.next(e))}catch(e){r(e)}}function u(e){try{c(i.throw(e))}catch(e){r(e)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(s,u)}c((i=i.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});t.Merkle=class{constructor(e){this.$options=Object.assign({hasher:e=>e},e)}notarize(e){return i(this,void 0,void 0,function*(){const t=[...e],n=[yield this.$options.hasher("")];for(let e=t.length-1;e>=0;e--){const i=n[0],o=t[e];n.unshift(yield this.$options.hasher(o));const r=n[0];n.unshift(yield this.$options.hasher(`${r}${i}`))}return{values:t.map((e,t)=>({index:t,value:e})),nodes:n.map((e,t)=>({index:t,hash:e}))}})}disclose(e,t){return i(this,void 0,void 0,function*(){const n=Math.max(...t.map(e=>e+1),0),i=[],o=[e.nodes.find(e=>e.index===2*n)];for(let r=n-1;r>=0;r--)-1!==t.indexOf(r)?i.unshift(e.values.find(e=>e.index===r)):o.unshift(e.nodes.find(e=>e.index===2*r+1));return{values:i,nodes:o}})}imprint(e){return i(this,void 0,void 0,function*(){const t=[...yield Promise.all(e.values.map(e=>i(this,void 0,void 0,function*(){return{index:2*e.index+1,hash:yield this.$options.hasher(e.value),value:e.value}}))),...e.nodes];for(let e=Math.max(...t.map(e=>e.index+1),0)-1;e>=0;e-=2){const n=t.find(t=>t.index===e),i=t.find(t=>t.index===e-1);n&&i&&t.unshift({index:e-2,hash:yield this.$options.hasher(`${i.hash}${n.hash}`)})}const n=t.find(e=>0===e.index);return n?n.hash:null})}}},70:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toString=function(e){try{return null==e?"":`${e}`}catch(e){return""}},t.cloneObject=function(e){return JSON.parse(JSON.stringify(e))},t.stepPaths=function(e){const t={"":[]};return e.forEach(e=>{let n=[];e.forEach(e=>{n.push(e),t[n.join(".")]=[...n]})}),Object.keys(t).sort().map(e=>t[e])},t.readPath=function e(t,n){try{return Array.isArray(t)?0===t.length?n:e(t.slice(1),n[t[0]]):void 0}catch(e){return}}}});