!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=115)}({11:function(t,e){t.exports=void 0},115:function(t,e,n){window.$0xcert=window.$0xcert||{},Object.assign(window.$0xcert,n(69))},12:function(t,e){var n,r,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function u(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(t){n=o}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(t){r=s}}();var c,a=[],f=!1,h=-1;function l(){f&&c&&(f=!1,c.length?a=c.concat(a):h=-1,a.length&&d())}function d(){if(!f){var t=u(l);f=!0;for(var e=a.length;e;){for(c=a,a=[];++h<e;)c&&c[h].run();h=-1,e=a.length}c=null,f=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function y(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];a.push(new p(t,e)),1!==a.length||f||u(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=y,i.addListener=y,i.once=y,i.off=y,i.removeListener=y,i.removeAllListeners=y,i.emit=y,i.prependListener=y,i.prependOnceListener=y,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},16:function(t,e,n){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(17)),r(n(19)),r(n(20)),r(n(23)),r(n(24)),r(n(25)),r(n(26)),r(n(27))},17:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{c(r.next(t))}catch(t){o(t)}}function u(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,u)}c((r=r.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0}),e.fetch=function(t,e){return r(this,void 0,void 0,function*(){return"undefined"!=typeof window?window.fetch(t,e):n(18)(t,e)})}},18:function(t,e,n){"use strict";var r=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==r)return r;throw new Error("unable to locate global object")}();t.exports=e=r.fetch,e.default=r.fetch.bind(r),e.Headers=r.Headers,e.Request=r.Request,e.Response=r.Response},19:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{c(r.next(t))}catch(t){o(t)}}function u(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,u)}c((r=r.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0}),e.sha=function(t,e){return r(this,void 0,void 0,function*(){if("undefined"!=typeof window){const n=new window.TextEncoder("utf-8").encode(e),r=yield window.crypto.subtle.digest(`SHA-${t}`,n);return Array.from(new Uint8Array(r)).map(t=>("00"+t.toString(16)).slice(-2)).join("")}return n(11).createHash(`sha${t}`).update(e).digest("hex")})}},20:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(21);e.keccak=function(t,e){return r[`keccak_${t}`](e)}},21:function(t,e,n){(function(r,i){var o;
/**
 * [js-sha3]{@link https://github.com/emn178/js-sha3}
 *
 * @version 0.8.0
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2015-2018
 * @license MIT
 */
/**
 * [js-sha3]{@link https://github.com/emn178/js-sha3}
 *
 * @version 0.8.0
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2015-2018
 * @license MIT
 */
!function(){"use strict";var s="input is invalid type",u="object"==typeof window,c=u?window:{};c.JS_SHA3_NO_WINDOW&&(u=!1);var a=!u&&"object"==typeof self;!c.JS_SHA3_NO_NODE_JS&&"object"==typeof r&&r.versions&&r.versions.node?c=i:a&&(c=self);var f=!c.JS_SHA3_NO_COMMON_JS&&"object"==typeof t&&t.exports,h=n(22),l=!c.JS_SHA3_NO_ARRAY_BUFFER&&"undefined"!=typeof ArrayBuffer,d="0123456789abcdef".split(""),p=[4,1024,262144,67108864],y=[0,8,16,24],v=[1,0,32898,0,32906,2147483648,2147516416,2147483648,32907,0,2147483649,0,2147516545,2147483648,32777,2147483648,138,0,136,0,2147516425,0,2147483658,0,2147516555,0,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,2147483648,32778,0,2147483658,2147483648,2147516545,2147483648,32896,2147483648,2147483649,0,2147516424,2147483648],b=[224,256,384,512],m=[128,256],w=["hex","buffer","arrayBuffer","array","digest"],g={128:168,256:136};!c.JS_SHA3_NO_NODE_JS&&Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)}),!l||!c.JS_SHA3_NO_ARRAY_BUFFER_IS_VIEW&&ArrayBuffer.isView||(ArrayBuffer.isView=function(t){return"object"==typeof t&&t.buffer&&t.buffer.constructor===ArrayBuffer});for(var _=function(t,e,n){return function(r){return new I(t,e,t).update(r)[n]()}},j=function(t,e,n){return function(r,i){return new I(t,e,i).update(r)[n]()}},x=function(t,e,n){return function(e,r,i,o){return S["cshake"+t].update(e,r,i,o)[n]()}},k=function(t,e,n){return function(e,r,i,o){return S["kmac"+t].update(e,r,i,o)[n]()}},O=function(t,e,n,r){for(var i=0;i<w.length;++i){var o=w[i];t[o]=e(n,r,o)}return t},P=function(t,e){var n=_(t,e,"hex");return n.create=function(){return new I(t,e,t)},n.update=function(t){return n.create().update(t)},O(n,_,t,e)},A=[{name:"keccak",padding:[1,256,65536,16777216],bits:b,createMethod:P},{name:"sha3",padding:[6,1536,393216,100663296],bits:b,createMethod:P},{name:"shake",padding:[31,7936,2031616,520093696],bits:m,createMethod:function(t,e){var n=j(t,e,"hex");return n.create=function(n){return new I(t,e,n)},n.update=function(t,e){return n.create(e).update(t)},O(n,j,t,e)}},{name:"cshake",padding:p,bits:m,createMethod:function(t,e){var n=g[t],r=x(t,0,"hex");return r.create=function(r,i,o){return i||o?new I(t,e,r).bytepad([i,o],n):S["shake"+t].create(r)},r.update=function(t,e,n,i){return r.create(e,n,i).update(t)},O(r,x,t,e)}},{name:"kmac",padding:p,bits:m,createMethod:function(t,e){var n=g[t],r=k(t,0,"hex");return r.create=function(r,i,o){return new N(t,e,i).bytepad(["KMAC",o],n).bytepad([r],n)},r.update=function(t,e,n,i){return r.create(t,n,i).update(e)},O(r,k,t,e)}}],S={},M=[],B=0;B<A.length;++B)for(var E=A[B],T=E.bits,$=0;$<T.length;++$){var C=E.name+"_"+T[$];if(M.push(C),S[C]=E.createMethod(T[$],E.padding),"sha3"!==E.name){var z=E.name+T[$];M.push(z),S[z]=S[C]}}function I(t,e,n){this.blocks=[],this.s=[],this.padding=e,this.outputBits=n,this.reset=!0,this.finalized=!1,this.block=0,this.start=0,this.blockCount=1600-(t<<1)>>5,this.byteCount=this.blockCount<<2,this.outputBlocks=n>>5,this.extraBytes=(31&n)>>3;for(var r=0;r<50;++r)this.s[r]=0}function N(t,e,n){I.call(this,t,e,n)}I.prototype.update=function(t){if(this.finalized)throw new Error("finalize already called");var e,n=typeof t;if("string"!==n){if("object"!==n)throw new Error(s);if(null===t)throw new Error(s);if(l&&t.constructor===ArrayBuffer)t=new Uint8Array(t);else if(!(Array.isArray(t)||l&&ArrayBuffer.isView(t)))throw new Error(s);e=!0}for(var r,i,o=this.blocks,u=this.byteCount,c=t.length,a=this.blockCount,f=0,h=this.s;f<c;){if(this.reset)for(this.reset=!1,o[0]=this.block,r=1;r<a+1;++r)o[r]=0;if(e)for(r=this.start;f<c&&r<u;++f)o[r>>2]|=t[f]<<y[3&r++];else for(r=this.start;f<c&&r<u;++f)(i=t.charCodeAt(f))<128?o[r>>2]|=i<<y[3&r++]:i<2048?(o[r>>2]|=(192|i>>6)<<y[3&r++],o[r>>2]|=(128|63&i)<<y[3&r++]):i<55296||i>=57344?(o[r>>2]|=(224|i>>12)<<y[3&r++],o[r>>2]|=(128|i>>6&63)<<y[3&r++],o[r>>2]|=(128|63&i)<<y[3&r++]):(i=65536+((1023&i)<<10|1023&t.charCodeAt(++f)),o[r>>2]|=(240|i>>18)<<y[3&r++],o[r>>2]|=(128|i>>12&63)<<y[3&r++],o[r>>2]|=(128|i>>6&63)<<y[3&r++],o[r>>2]|=(128|63&i)<<y[3&r++]);if(this.lastByteIndex=r,r>=u){for(this.start=r-u,this.block=o[a],r=0;r<a;++r)h[r]^=o[r];J(h),this.reset=!0}else this.start=r}return this},I.prototype.encode=function(t,e){var n=255&t,r=1,i=[n];for(n=255&(t>>=8);n>0;)i.unshift(n),n=255&(t>>=8),++r;return e?i.push(r):i.unshift(r),this.update(i),i.length},I.prototype.encodeString=function(t){var e,n=typeof t;if("string"!==n){if("object"!==n)throw new Error(s);if(null===t)throw new Error(s);if(l&&t.constructor===ArrayBuffer)t=new Uint8Array(t);else if(!(Array.isArray(t)||l&&ArrayBuffer.isView(t)))throw new Error(s);e=!0}var r=0,i=t.length;if(e)r=i;else for(var o=0;o<t.length;++o){var u=t.charCodeAt(o);u<128?r+=1:u<2048?r+=2:u<55296||u>=57344?r+=3:(u=65536+((1023&u)<<10|1023&t.charCodeAt(++o)),r+=4)}return r+=this.encode(8*r),this.update(t),r},I.prototype.bytepad=function(t,e){for(var n=this.encode(e),r=0;r<t.length;++r)n+=this.encodeString(t[r]);var i=e-n%e,o=[];return o.length=i,this.update(o),this},I.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var t=this.blocks,e=this.lastByteIndex,n=this.blockCount,r=this.s;if(t[e>>2]|=this.padding[3&e],this.lastByteIndex===this.byteCount)for(t[0]=t[n],e=1;e<n+1;++e)t[e]=0;for(t[n-1]|=2147483648,e=0;e<n;++e)r[e]^=t[e];J(r)}},I.prototype.toString=I.prototype.hex=function(){this.finalize();for(var t,e=this.blockCount,n=this.s,r=this.outputBlocks,i=this.extraBytes,o=0,s=0,u="";s<r;){for(o=0;o<e&&s<r;++o,++s)t=n[o],u+=d[t>>4&15]+d[15&t]+d[t>>12&15]+d[t>>8&15]+d[t>>20&15]+d[t>>16&15]+d[t>>28&15]+d[t>>24&15];s%e==0&&(J(n),o=0)}return i&&(t=n[o],u+=d[t>>4&15]+d[15&t],i>1&&(u+=d[t>>12&15]+d[t>>8&15]),i>2&&(u+=d[t>>20&15]+d[t>>16&15])),u},I.prototype.arrayBuffer=function(){this.finalize();var t,e=this.blockCount,n=this.s,r=this.outputBlocks,i=this.extraBytes,o=0,s=0,u=this.outputBits>>3;t=i?new ArrayBuffer(r+1<<2):new ArrayBuffer(u);for(var c=new Uint32Array(t);s<r;){for(o=0;o<e&&s<r;++o,++s)c[s]=n[o];s%e==0&&J(n)}return i&&(c[o]=n[o],t=t.slice(0,u)),t},I.prototype.buffer=I.prototype.arrayBuffer,I.prototype.digest=I.prototype.array=function(){this.finalize();for(var t,e,n=this.blockCount,r=this.s,i=this.outputBlocks,o=this.extraBytes,s=0,u=0,c=[];u<i;){for(s=0;s<n&&u<i;++s,++u)t=u<<2,e=r[s],c[t]=255&e,c[t+1]=e>>8&255,c[t+2]=e>>16&255,c[t+3]=e>>24&255;u%n==0&&J(r)}return o&&(t=u<<2,e=r[s],c[t]=255&e,o>1&&(c[t+1]=e>>8&255),o>2&&(c[t+2]=e>>16&255)),c},N.prototype=new I,N.prototype.finalize=function(){return this.encode(this.outputBits,!0),I.prototype.finalize.call(this)};var J=function(t){var e,n,r,i,o,s,u,c,a,f,h,l,d,p,y,b,m,w,g,_,j,x,k,O,P,A,S,M,B,E,T,$,C,z,I,N,J,H,R,F,U,D,L,V,W,q,G,Y,K,Q,X,Z,tt,et,nt,rt,it,ot,st,ut,ct,at,ft;for(r=0;r<48;r+=2)i=t[0]^t[10]^t[20]^t[30]^t[40],o=t[1]^t[11]^t[21]^t[31]^t[41],s=t[2]^t[12]^t[22]^t[32]^t[42],u=t[3]^t[13]^t[23]^t[33]^t[43],c=t[4]^t[14]^t[24]^t[34]^t[44],a=t[5]^t[15]^t[25]^t[35]^t[45],f=t[6]^t[16]^t[26]^t[36]^t[46],h=t[7]^t[17]^t[27]^t[37]^t[47],e=(l=t[8]^t[18]^t[28]^t[38]^t[48])^(s<<1|u>>>31),n=(d=t[9]^t[19]^t[29]^t[39]^t[49])^(u<<1|s>>>31),t[0]^=e,t[1]^=n,t[10]^=e,t[11]^=n,t[20]^=e,t[21]^=n,t[30]^=e,t[31]^=n,t[40]^=e,t[41]^=n,e=i^(c<<1|a>>>31),n=o^(a<<1|c>>>31),t[2]^=e,t[3]^=n,t[12]^=e,t[13]^=n,t[22]^=e,t[23]^=n,t[32]^=e,t[33]^=n,t[42]^=e,t[43]^=n,e=s^(f<<1|h>>>31),n=u^(h<<1|f>>>31),t[4]^=e,t[5]^=n,t[14]^=e,t[15]^=n,t[24]^=e,t[25]^=n,t[34]^=e,t[35]^=n,t[44]^=e,t[45]^=n,e=c^(l<<1|d>>>31),n=a^(d<<1|l>>>31),t[6]^=e,t[7]^=n,t[16]^=e,t[17]^=n,t[26]^=e,t[27]^=n,t[36]^=e,t[37]^=n,t[46]^=e,t[47]^=n,e=f^(i<<1|o>>>31),n=h^(o<<1|i>>>31),t[8]^=e,t[9]^=n,t[18]^=e,t[19]^=n,t[28]^=e,t[29]^=n,t[38]^=e,t[39]^=n,t[48]^=e,t[49]^=n,p=t[0],y=t[1],q=t[11]<<4|t[10]>>>28,G=t[10]<<4|t[11]>>>28,M=t[20]<<3|t[21]>>>29,B=t[21]<<3|t[20]>>>29,ut=t[31]<<9|t[30]>>>23,ct=t[30]<<9|t[31]>>>23,D=t[40]<<18|t[41]>>>14,L=t[41]<<18|t[40]>>>14,z=t[2]<<1|t[3]>>>31,I=t[3]<<1|t[2]>>>31,b=t[13]<<12|t[12]>>>20,m=t[12]<<12|t[13]>>>20,Y=t[22]<<10|t[23]>>>22,K=t[23]<<10|t[22]>>>22,E=t[33]<<13|t[32]>>>19,T=t[32]<<13|t[33]>>>19,at=t[42]<<2|t[43]>>>30,ft=t[43]<<2|t[42]>>>30,et=t[5]<<30|t[4]>>>2,nt=t[4]<<30|t[5]>>>2,N=t[14]<<6|t[15]>>>26,J=t[15]<<6|t[14]>>>26,w=t[25]<<11|t[24]>>>21,g=t[24]<<11|t[25]>>>21,Q=t[34]<<15|t[35]>>>17,X=t[35]<<15|t[34]>>>17,$=t[45]<<29|t[44]>>>3,C=t[44]<<29|t[45]>>>3,O=t[6]<<28|t[7]>>>4,P=t[7]<<28|t[6]>>>4,rt=t[17]<<23|t[16]>>>9,it=t[16]<<23|t[17]>>>9,H=t[26]<<25|t[27]>>>7,R=t[27]<<25|t[26]>>>7,_=t[36]<<21|t[37]>>>11,j=t[37]<<21|t[36]>>>11,Z=t[47]<<24|t[46]>>>8,tt=t[46]<<24|t[47]>>>8,V=t[8]<<27|t[9]>>>5,W=t[9]<<27|t[8]>>>5,A=t[18]<<20|t[19]>>>12,S=t[19]<<20|t[18]>>>12,ot=t[29]<<7|t[28]>>>25,st=t[28]<<7|t[29]>>>25,F=t[38]<<8|t[39]>>>24,U=t[39]<<8|t[38]>>>24,x=t[48]<<14|t[49]>>>18,k=t[49]<<14|t[48]>>>18,t[0]=p^~b&w,t[1]=y^~m&g,t[10]=O^~A&M,t[11]=P^~S&B,t[20]=z^~N&H,t[21]=I^~J&R,t[30]=V^~q&Y,t[31]=W^~G&K,t[40]=et^~rt&ot,t[41]=nt^~it&st,t[2]=b^~w&_,t[3]=m^~g&j,t[12]=A^~M&E,t[13]=S^~B&T,t[22]=N^~H&F,t[23]=J^~R&U,t[32]=q^~Y&Q,t[33]=G^~K&X,t[42]=rt^~ot&ut,t[43]=it^~st&ct,t[4]=w^~_&x,t[5]=g^~j&k,t[14]=M^~E&$,t[15]=B^~T&C,t[24]=H^~F&D,t[25]=R^~U&L,t[34]=Y^~Q&Z,t[35]=K^~X&tt,t[44]=ot^~ut&at,t[45]=st^~ct&ft,t[6]=_^~x&p,t[7]=j^~k&y,t[16]=E^~$&O,t[17]=T^~C&P,t[26]=F^~D&z,t[27]=U^~L&I,t[36]=Q^~Z&V,t[37]=X^~tt&W,t[46]=ut^~at&et,t[47]=ct^~ft&nt,t[8]=x^~p&b,t[9]=k^~y&m,t[18]=$^~O&A,t[19]=C^~P&S,t[28]=D^~z&N,t[29]=L^~I&J,t[38]=Z^~V&q,t[39]=tt^~W&G,t[48]=at^~et&rt,t[49]=ft^~nt&it,t[0]^=v[r],t[1]^=v[r+1]};if(f)t.exports=S;else{for(B=0;B<M.length;++B)c[M[B]]=S[M[B]];h&&(void 0===(o=function(){return S}.call(e,n,e,t))||(t.exports=o))}}()}).call(this,n(12),n(4))},22:function(t,e){(function(e){t.exports=e}).call(this,{})},23:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.toFloat=function(t){return parseFloat(`${t}`)||0}},24:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.toInteger=function(t){return parseInt(`${t}`)||0}},25:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.toSeconds=function(t){return parseInt(`${parseFloat(`${t}`)/1e3}`)||0}},26:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.toString=function(t){return null!=t?t.toString():null}},27:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.toTuple=function t(e){if(!(e instanceof Object))return[];var n=[],r=0;return Object.keys(e).forEach(i=>{if(e[i]instanceof Object)n[r]=t(e[i]);else if(e[i]instanceof Array){let o=0,s=[];e[i].forEach(n=>{s[o]=t(e[i]),o++}),n[r]=s}else n[r]=e[i];r++}),n}},4:function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},69:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(70))},70:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{c(r.next(t))}catch(t){o(t)}}function u(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,u)}c((r=r.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0});const i=n(16),o=n(71),s=n(73);e.Cert=class{constructor(t){this.schema=t.schema,this.merkle=new o.Merkle(Object.assign({hasher:t=>i.sha(256,s.toString(t))},t))}notarize(t){return r(this,void 0,void 0,function*(){const e=this.buildSchemaProps(t),n=yield this.buildCompoundProps(e);return(yield this.buildProofs(n)).map(t=>({path:t.path,nodes:t.nodes,values:t.values}))})}disclose(t,e){return r(this,void 0,void 0,function*(){const n=this.buildSchemaProps(t),r=yield this.buildCompoundProps(n);return(yield this.buildProofs(r,e)).map(t=>({path:t.path,nodes:t.nodes,values:t.values}))})}calculate(t,e){return r(this,void 0,void 0,function*(){try{return this.checkDataInclusion(t,e)?this.imprintProofs(e):null}catch(t){return null}})}imprint(t){return r(this,void 0,void 0,function*(){return this.notarize(t).then(t=>t[0].nodes[0].hash)})}buildSchemaProps(t,e=this.schema,n=[]){return"array"===e.type?(t||[]).map((t,r)=>this.buildSchemaProps(t,e.items,[...n,r])).reduce((t,e)=>t.concat(e),[]):"object"===e.type?Object.keys(e.properties).sort().map(r=>{const i=this.buildSchemaProps((t||{})[r],e.properties[r],[...n,r]);return-1===["object","array"].indexOf(e.properties[r].type)?[i]:i}).reduce((t,e)=>t.concat(e),[]):{path:n,value:t,key:n.join("."),group:n.slice(0,-1).join(".")}}buildCompoundProps(t){return r(this,void 0,void 0,function*(){t=[...t];const e=this.buildPropGroups(t),n=Object.keys(e).sort((t,e)=>t>e?-1:1).filter(t=>""!==t);for(const r of n){const n=e[r],i=[...t.filter(t=>t.group===r)].sort((t,e)=>t.key>e.key?1:-1).map(t=>t.value),o=yield this.merkle.notarize(i);t.push({path:n,value:o.nodes[0].hash,key:n.join("."),group:n.slice(0,-1).join(".")})}return t.sort((t,e)=>t.key>e.key?1:-1)})}buildProofs(t,e=null){return r(this,void 0,void 0,function*(){const n=e?s.stepPaths(e).map(t=>t.join(".")):null,i={};return t.forEach(t=>i[t.group]=t.path.slice(0,-1)),Promise.all(Object.keys(i).map(e=>r(this,void 0,void 0,function*(){const r=t.filter(t=>t.group===e).map(t=>t.value);let o=yield this.merkle.notarize(r);if(n){const r=t.filter(t=>t.group===e).map((t,e)=>-1===n.indexOf(t.key)?-1:e).filter(t=>-1!==t);o=yield this.merkle.disclose(o,r)}if(!n||-1!==n.indexOf(i[e].join(".")))return{path:i[e],values:o.values,nodes:o.nodes,key:i[e].join("."),group:i[e].slice(0,-1).join(".")}}))).then(t=>t.filter(t=>!!t))})}checkDataInclusion(t,e){const n=this.buildSchemaProps(t);e=s.cloneObject(e).map(t=>Object.assign({key:t.path.join("."),group:t.path.slice(0,-1).join(".")},t));for(const r of n){const n=s.readPath(r.path,t);if(void 0===n)continue;const i=r.path.slice(0,-1).join("."),o=e.find(t=>t.key===i);if(!o)return!1;const u=this.getPathIndexes(r.path).pop();if(o.values.find(t=>t.index===u).value!==n)return!1}return!0}imprintProofs(t){return r(this,void 0,void 0,function*(){if(0===t.length)return this.getEmptyImprint();t=s.cloneObject(t).map(t=>Object.assign({key:t.path.join("."),group:t.path.slice(0,-1).join(".")},t)).sort((t,e)=>t.path.length>e.path.length?-1:1);for(const e of t){const n=yield this.merkle.imprint(e).catch(()=>"");e.nodes.unshift({index:0,hash:n});const r=e.path.slice(0,-1).join("."),i=this.getPathIndexes(e.path).slice(-1).pop(),o=t.find(t=>t.key===r);o&&o.values.unshift({index:i,value:n})}const e=t.find(t=>""===t.key);return e?e.nodes.find(t=>0===t.index).hash:this.getEmptyImprint()})}getPathIndexes(t){const e=[];let n=this.schema;for(const r of t)"array"===n.type?(e.push(r),n=n.items):"object"===n.type?(e.push(Object.keys(n.properties).sort().indexOf(r)),n=n.properties[r]):e.push(void 0);return e}getEmptyImprint(){return r(this,void 0,void 0,function*(){return this.merkle.notarize([]).then(t=>t.nodes[0].hash)})}buildPropGroups(t){const e={};return t.map(t=>{let e=[];return t.path.map(t=>(e.push(t),[...e]))}).reduce((t,e)=>t.concat(e),[]).forEach(t=>e[t.slice(0,-1).join(".")]=t.slice(0,-1)),e}}},71:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(72))},72:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{c(r.next(t))}catch(t){o(t)}}function u(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,u)}c((r=r.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0});e.Merkle=class{constructor(t){this.$options=Object.assign({hasher:t=>t},t)}notarize(t){return r(this,void 0,void 0,function*(){const e=[...t],n=[yield this.$options.hasher("")];for(let t=e.length-1;t>=0;t--){const r=n[0],i=e[t];n.unshift(yield this.$options.hasher(i));const o=n[0];n.unshift(yield this.$options.hasher(`${o}${r}`))}return{values:e.map((t,e)=>({index:e,value:t})),nodes:n.map((t,e)=>({index:e,hash:t}))}})}disclose(t,e){return r(this,void 0,void 0,function*(){const n=Math.max(...e.map(t=>t+1),0),r=[],i=[t.nodes.find(t=>t.index===2*n)];for(let o=n-1;o>=0;o--)-1!==e.indexOf(o)?r.unshift(t.values.find(t=>t.index===o)):i.unshift(t.nodes.find(t=>t.index===2*o+1));return{values:r,nodes:i}})}imprint(t){return r(this,void 0,void 0,function*(){const e=[...yield Promise.all(t.values.map(t=>r(this,void 0,void 0,function*(){return{index:2*t.index+1,hash:yield this.$options.hasher(t.value),value:t.value}}))),...t.nodes];for(let t=Math.max(...e.map(t=>t.index+1),0)-1;t>=0;t-=2){const n=e.find(e=>e.index===t),r=e.find(e=>e.index===t-1);n&&r&&e.unshift({index:t-2,hash:yield this.$options.hasher(`${r.hash}${n.hash}`)})}const n=e.find(t=>0===t.index);return n?n.hash:null})}}},73:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.toString=function(t){try{return null==t?"":`${t}`}catch(t){return""}},e.cloneObject=function(t){return JSON.parse(JSON.stringify(t))},e.stepPaths=function(t){const e={"":[]};return t.forEach(t=>{let n=[];t.forEach(t=>{n.push(t),e[n.join(".")]=[...n]})}),Object.keys(e).sort().map(t=>e[t])},e.readPath=function t(e,n){try{return Array.isArray(e)?0===e.length?n:t(e.slice(1),n[e[0]]):void 0}catch(t){return}}}});