!function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=3)}([,,,function(t,e,n){window.$0xcert=window.$0xcert||{},window.$0xcert.client=n(4)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(5))},function(t,e,n){"use strict";var i=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))(function(r,o){function s(t){try{c(i.next(t))}catch(t){o(t)}}function u(t){try{c(i.throw(t))}catch(t){o(t)}}function c(t){t.done?r(t.value):new n(function(e){e(t.value)}).then(s,u)}c((i=i.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0});const r=n(6);e.Client=class{constructor(t){this.connector=t.connector}sign(t){return i(this,void 0,void 0,function*(){return this.connector.sign(t)})}getMutation(t){return i(this,void 0,void 0,function*(){return this.connector.getMutation(t)})}getOrderExchange(t=null){return i(this,void 0,void 0,function*(){return this.connector.getOrderExchange(t)})}getAssetLedger(t){return i(this,void 0,void 0,function*(){return this.connector.getAssetLedger(t)})}getValueLedger(t){return i(this,void 0,void 0,function*(){return this.connector.getValueLedger(t)})}createQueue(t){return null}createCert(t){return new r.Cert(t)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(7))},function(t,e,n){"use strict";var i=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))(function(r,o){function s(t){try{c(i.next(t))}catch(t){o(t)}}function u(t){try{c(i.throw(t))}catch(t){o(t)}}function c(t){t.done?r(t.value):new n(function(e){e(t.value)}).then(s,u)}c((i=i.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0});const r=n(8),o=n(11),s=n(13);e.Cert=class{constructor(t){this.schema=t.schema,this.merkle=new o.Merkle(Object.assign({hasher:t=>r.sha256(s.toString(t))},t))}notarize(t){return i(this,void 0,void 0,function*(){const e=this.buildSchemaProps(t),n=yield this.buildCompoundProps(e);return(yield this.buildProofs(n)).map(t=>({path:t.path,nodes:t.nodes,values:t.values}))})}disclose(t,e){return i(this,void 0,void 0,function*(){const n=this.buildSchemaProps(t),i=yield this.buildCompoundProps(n);return(yield this.buildProofs(i,e)).map(t=>({path:t.path,nodes:t.nodes,values:t.values}))})}calculate(t,e){return i(this,void 0,void 0,function*(){try{return this.checkDataInclusion(t,e)?this.imprintProofs(e):null}catch(t){return null}})}imprint(t){return i(this,void 0,void 0,function*(){return this.notarize(t).then(t=>t[0].nodes[0].hash)})}buildSchemaProps(t,e=this.schema,n=[]){return"array"===e.type?(t||[]).map((t,i)=>this.buildSchemaProps(t,e.items,[...n,i])).reduce((t,e)=>t.concat(e),[]):"object"===e.type?Object.keys(e.properties).sort().map(i=>{const r=this.buildSchemaProps((t||{})[i],e.properties[i],[...n,i]);return-1===["object","array"].indexOf(e.properties[i].type)?[r]:r}).reduce((t,e)=>t.concat(e),[]):{path:n,value:t,key:n.join("."),group:n.slice(0,-1).join(".")}}buildCompoundProps(t){return i(this,void 0,void 0,function*(){t=[...t];const e=this.buildPropGroups(t),n=Object.keys(e).sort((t,e)=>t>e?-1:1).filter(t=>""!==t);for(const i of n){const n=e[i],r=[...t.filter(t=>t.group===i)].sort((t,e)=>t.key>e.key?1:-1).map(t=>t.value),o=yield this.merkle.notarize(r);t.push({path:n,value:o.nodes[0].hash,key:n.join("."),group:n.slice(0,-1).join(".")})}return t.sort((t,e)=>t.key>e.key?1:-1)})}buildProofs(t,e=null){return i(this,void 0,void 0,function*(){const n=e?s.stepPaths(e).map(t=>t.join(".")):null,r={};return t.forEach(t=>r[t.group]=t.path.slice(0,-1)),Promise.all(Object.keys(r).map(e=>i(this,void 0,void 0,function*(){const i=t.filter(t=>t.group===e).map(t=>t.value);let o=yield this.merkle.notarize(i);if(n){const i=t.filter(t=>t.group===e).map((t,e)=>-1===n.indexOf(t.key)?-1:e).filter(t=>-1!==t);o=yield this.merkle.disclose(o,i)}if(!n||-1!==n.indexOf(r[e].join(".")))return{path:r[e],values:o.values,nodes:o.nodes,key:r[e].join("."),group:r[e].slice(0,-1).join(".")}}))).then(t=>t.filter(t=>!!t))})}checkDataInclusion(t,e){const n=this.buildSchemaProps(t);e=s.cloneObject(e).map(t=>Object.assign({key:t.path.join("."),group:t.path.slice(0,-1).join(".")},t));for(const i of n){const n=s.readPath(i.path,t);if(void 0===n)continue;const r=i.path.slice(0,-1).join("."),o=e.find(t=>t.key===r);if(!o)return!1;const u=this.getPathIndexes(i.path).pop();if(o.values.find(t=>t.index===u).value!==n)return!1}return!0}imprintProofs(t){return i(this,void 0,void 0,function*(){if(0===t.length)return this.getEmptyImprint();t=s.cloneObject(t).map(t=>Object.assign({key:t.path.join("."),group:t.path.slice(0,-1).join(".")},t)).sort((t,e)=>t.path.length>e.path.length?-1:1);for(const e of t){const n=yield this.merkle.imprint(e).catch(()=>"");e.nodes.unshift({index:0,hash:n});const i=e.path.slice(0,-1).join("."),r=this.getPathIndexes(e.path).slice(-1).pop(),o=t.find(t=>t.key===i);o&&o.values.unshift({index:r,value:n})}const e=t.find(t=>""===t.key);return e?e.nodes.find(t=>0===t.index).hash:this.getEmptyImprint()})}getPathIndexes(t){const e=[];let n=this.schema;for(const i of t)"array"===n.type?(e.push(i),n=n.items):"object"===n.type?(e.push(Object.keys(n.properties).sort().indexOf(i)),n=n.properties[i]):e.push(void 0);return e}getEmptyImprint(){return i(this,void 0,void 0,function*(){return this.merkle.notarize([]).then(t=>t.nodes[0].hash)})}buildPropGroups(t){const e={};return t.map(t=>{let e=[];return t.path.map(t=>(e.push(t),[...e]))}).reduce((t,e)=>t.concat(e),[]).forEach(t=>e[t.slice(0,-1).join(".")]=t.slice(0,-1)),e}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(9))},function(t,e,n){"use strict";var i=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))(function(r,o){function s(t){try{c(i.next(t))}catch(t){o(t)}}function u(t){try{c(i.throw(t))}catch(t){o(t)}}function c(t){t.done?r(t.value):new n(function(e){e(t.value)}).then(s,u)}c((i=i.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0});const r=n(10);e.sha256=function(t){return i(this,void 0,void 0,function*(){return r.sha(256,t)})}},function(t,e,n){"use strict";var i=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))(function(r,o){function s(t){try{c(i.next(t))}catch(t){o(t)}}function u(t){try{c(i.throw(t))}catch(t){o(t)}}function c(t){t.done?r(t.value):new n(function(e){e(t.value)}).then(s,u)}c((i=i.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0}),e.sha=function(t,e){return i(this,void 0,void 0,function*(){if("undefined"!=typeof window){const n=new window.TextEncoder("utf-8").encode(e),i=yield window.crypto.subtle.digest(`SHA-${t}`,n);return Array.from(new Uint8Array(i)).map(t=>("00"+t.toString(16)).slice(-2)).join("")}})}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(12))},function(t,e,n){"use strict";var i=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))(function(r,o){function s(t){try{c(i.next(t))}catch(t){o(t)}}function u(t){try{c(i.throw(t))}catch(t){o(t)}}function c(t){t.done?r(t.value):new n(function(e){e(t.value)}).then(s,u)}c((i=i.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0});e.Merkle=class{constructor(t){this.config=Object.assign({hasher:t=>t},t)}notarize(t){return i(this,void 0,void 0,function*(){const e=[...t],n=[yield this.config.hasher("")];for(let t=e.length-1;t>=0;t--){const i=n[0],r=e[t];n.unshift(yield this.config.hasher(r));const o=n[0];n.unshift(yield this.config.hasher(`${o}${i}`))}return{values:e.map((t,e)=>({index:e,value:t})),nodes:n.map((t,e)=>({index:e,hash:t}))}})}disclose(t,e){return i(this,void 0,void 0,function*(){const n=Math.max(...e.map(t=>t+1),0),i=[],r=[t.nodes.find(t=>t.index===2*n)];for(let o=n-1;o>=0;o--)-1!==e.indexOf(o)?i.unshift(t.values.find(t=>t.index===o)):r.unshift(t.nodes.find(t=>t.index===2*o+1));return{values:i,nodes:r}})}imprint(t){return i(this,void 0,void 0,function*(){const e=[...yield Promise.all(t.values.map(t=>i(this,void 0,void 0,function*(){return{index:2*t.index+1,hash:yield this.config.hasher(t.value),value:t.value}}))),...t.nodes];for(let t=Math.max(...e.map(t=>t.index+1),0)-1;t>=0;t-=2){const n=e.find(e=>e.index===t),i=e.find(e=>e.index===t-1);n&&i&&e.unshift({index:t-2,hash:yield this.config.hasher(`${i.hash}${n.hash}`)})}const n=e.find(t=>0===t.index);return n?n.hash:null})}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.toString=function(t){try{return null==t?"":`${t}`}catch(t){return""}},e.cloneObject=function(t){return JSON.parse(JSON.stringify(t))},e.stepPaths=function(t){const e={"":[]};return t.forEach(t=>{let n=[];t.forEach(t=>{n.push(t),e[n.join(".")]=[...n]})}),Object.keys(e).sort().map(t=>e[t])},e.readPath=function t(e,n){try{return Array.isArray(e)?0===e.length?n:t(e.slice(1),n[e[0]]):void 0}catch(t){return}}}]);